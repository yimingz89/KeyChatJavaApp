package main

import "os"
import "fmt"
import "triplesec"
import "encoding/hex"


func main() {
	
	cipherstring, _ := hex.DecodeString(os.Args[2])
	//cipherstring, _ := hex.DecodeString("1c94d7de00000003d283d7c247460f580a4f6ab78ab7bd373f9b2c539f952535695a471f984c4a6129b85cd5530a41cdb5819eda22bf40c8182ccacccbd05aa7d4d2ff4d584832018900e39604a92aa0c499a6ffc7a859d08cf8510237ddaf66bfc55db58d366e40e06aa1cdbd427e38ca9cadaa799d99e57a5e765d70a4077bf3d0437589519d93f90c08d2de72f731af9f905691dbaf484b815e90d286c1a5734543fcb4ea0ecf218f60699b638a95258dbf512a2d9add1e5131c041a67586c1068e36a0accea5ce71be46632a9f2c2421c34bcb6e03814879760641263386459f56ab98cfcfa5ab68a14ba41ad2b8468353d83ee6a89eb84e1eb0bcf8c1b87f1f70d1804b0d7419e6b3719b422cb3c1504471ec07ec42254bd4ec3d44091e609e42444034f38fa0e20db21b8e04befb3fa7dedcb8e69aefd0225364c8d9fdeb246c0e90b1c546de01af8e3bb861c13a309f0aa713710b79838ec349e81e5786e4b9cc78d369c56708ddd6a791653ce1ba76cd636ca48d500f6dd841c22a051bcea5bc4a889d6d8d079714d1826d13c4110db7e4d9a4fea9b79950c4ff7d040d6a3b827348d6718fff516afab362230f06e94b703bb544ea84ec8fa78bdc8591dd32a79a97c4ea993164185d364e7222028473a83c261178dcca64a476fe3424486ddf4c6d4af6c93f90ee064906ad371f64e207fddec7eb90daa7e9835ce782c7e04dfe9e42f8e229c9b7ff79064d2b656f74769c202cbc12c1ad4299b0957158b2c91fabd5889ac66aa2099c063e241bbc17f8b84e6b768bc1035e5f93e7a2670f7fe7364e9eef87c7c3a157ea6cf5b18f6322af90b5392ea8e8abb661af587958af6951f34fa2f8a6aefa01e4167511fbb58c9730f385fe4a69de13bc571b20a247f2e455e8311b25a388fda614f92b1b9ed5ce2bd9ae33d0812c05799888d0bfb0229daaf8702a37da51c13a5d7fa7f0ddb4cb1526ddafc1294f63db95d351ccfd01f8fa730f19691444a457aba3de0a03909663eadd2cfcc9a6148e8c5a8dc9a3da16203d54089f97dcf5f93ce236e4e3ea03045eccf5acbe479bb7a236b18f0bd4f1f545f5b3746320dbf58171f957ab203b6737f1de02fc3cc7aade987eef6860f7c84f6ce26acdd6eee257e29a79a66b8efa235ea3273224dd9a101a48b94e7f51314f485a5927f76b5262744b5e0b1f95965d49b815b6ab6fc56598294c46366169c0953eb043c4f9cef4317e5ea94d9fed96d4318e549a609a46b2cbda37426233a18f36c587010be5d4c07f3c7fb29818ebe20b6f6c07dc80f76f12cdebf7a7763aac0f4bfc592987268cc4abb6b024ac08bf1606551c8c987f66fb27aa6bdc60b7759cdc71db29c3b093f4d913f4c4a46ffbbf4032759e22f0043d47685787b69829cef2fb72ed9d24819f12048b6017cd7923b8a6d750aafbb432d122d99bbd919fcf80557426ce394cba2cdcd1f2a787305017aa45fe58388cac06ba2ec5115ca9b98c88e4bed97b2e450bca6b9c0cdb61dbd13e62c0a9adf85179cc89c9bae8578debc780807dc811dbaa55a5abd995a0931363444a149d24c26c91208ffd5a6263b039bd3a4e6fa66f423b0386be9c82b0440f7d8dda865b623c4988a733ca6a69b1c864a99496f3b92e43e3fcb770ba392f9b0cb26c2b5e5d59155312f83fcea8ef728d51bd13ffd0ecc2122fbe87efdf7ca11862124e65acc7f8f73491ec3b9a31f49e0f887414eae2eb514b25b24d503e949ce76dc02b8ef7e262c7d4f39271561f13d5fd7764dbe73bdf3f69947b6b71c7f81b1729a0388b33451455744f76c65f22b4c2200f132af8dd991343001a7214f3e489a654da0b11d111cc6788245fa07720cd476eb7e7735aca1561a292a581cd90460cb105d54b64007529c3a42e8508e6cba7dc7b42c628f8b98949c40fc3dc3f2a4ef04dd586fc9244f039b1ede336a9f6eddb173699b8d8f85f3a31077651ee1b427cc6b9486086b321f95b559da48178560fabe58b7c3f68a5bde925a4f623af113b7581fdf671635013ba0d427762333aee8c56c2a302916be3dd3b71a8ceb472234bee8ab909b4d184d2cb9ac7b5eeaebfb030bce5f40bc5f2f72136834b40f89b9cb9eea318b065a2a754bb66ee98aa614c257e0b192f6aa84b6d7bd48d80cfd7d08f580ad7dabf5f0c357ff6a7080e1dbb83213e6555b53ca0a2f67165a8362529eecd4cf0334db03df046433952662b5955d8766aff676c9394cef0c22af43607d9d864b629cdb2aa426aa3ba6d48f8610838c92143362cc689dd01d3c8fbe618a2a33f7e822e25aade58c25b8204456ba55bab94fc5adb1e4de25b8a405506339e53a613667a805def94049fa3a8b2a91ba8f671fab01bddc8d7176f198dc653035d0d1ed9a01874578802ece5fb037dfdaa7f371e4a9c8c755d8778b73f9648cc9e758800126cd0384fe2488b557484a91ce9c995e32fd9bf2364fa4303a66654be9461d3428b5e1632c2ec29b5c4f175e043ce764708d650aa8ec7ec9481f716a83a611572ef23a535ec534eab7e99f16ed0eddccf33bf25a9859a370604ead6ffe645f516942b20ef101e1634bf71e620600a39b3c17e2fcebf3411dc5cb09884f76cc8aec27e7918cf4bd4d81a8812c864df714f2bf96a2373c31c2981eaf40707c16b27ea306d0e6ad4aab30796699d0bbd4ec20a44e3fe0cb49393bf37dbb77a2f2bf2caae782c3f00038d23c6a20c164990c661f05b0d1f9eded6fab9007bedd8a4f91caabe068fb1f851c3800198ca8cd6017dd14d8a214151e3653bbfb5b1735d1da30db65106afc0d01adc6fa53bd68feb5711fbffbf01d5d4a3d172ee5be5a29cfb1239b1878b1d1a08b15ea7cf5ff9f7c4e0c63b1d2451017f7524bc63002f1b382bb912aedd8ef4b712f2e4de19746e3648bb7860d7340f7a1a740dc5df062b233642d2ad09bbb4bb1094ce2f11c1da1e39602e829760430bdd9e2071999e94512ac721aca51ee411ab25e55b67a4346d0fbadf63e1a112585453a6fe4db8d369615ccfd5f0d92dc3adf41f0c5fbb0c082d94f22ac81b246fcaf50a2d21b187b12eeccfdafe2fc5c20f3952d7959d7a61b628b76c834d02dc326324f65e8d8a1afdaa4c3019835317d956327eead93a0bb5905e44ddf9961a10df2f768e147b73e6c1423e46532756bc1e7a762e0f55a910166b1ce7830c2a70c25fb9e41f3540fef34831715d2969f4efec052239990061d769ba6055a875b2469cf70c2e1171ca0792088d0f1174a46cfb7288eea2488edc430dfc4d71a0821146f28cee026b1dc0d666ca2b1cd38895319d71e35ee68614c3b6e11758df61ff1fe25ca22a962a7800d555dfedee58f032d171272bf39e9abe00c4c93df9a80a57ca798188db7b93b0ecfc1feb4c5657867a62734a8bd7bef5ddb1a3ecda4d36bb7badf7917f42887bf8234922b621eb98d14708b09f8bc6026266b2f82841adb6fb51a1b020d215bfeb7a3caac4934b9322d051215d113dacab5eef7e9edaad3b049abe60eafd70d8b4868a5a9e3193b3df84a5a311027774bbda1187c1d8516bc8614f4891d6f8209df3011efe2b58ded680f65c226bbe155ea7f4d011e1749dc12f2f6844509ef340e859b2b0900028578825f7731711b30a7eaea7203a2f062791b420fcbbe35e673b255e47959488ccb760f67930dac3b386dc1cf2415146657e0d067c2d33b4d4121ba419506a9b42dae20245a186409e2523bdd4be003735f876e4585878282c3019b3c3ae2762518a524b49554484a6507bc6627192036bcc997581cf4e80138263361c510e658f20400bfd5b0d4de6b3fd808464e156e5d8a2d314b2b5efbdf702922f5e3fb6cf0c5418ddc12f1b120101b3308784cdd623fc1dbbcbaaa9f94fd1be55589249c79c6276e061b01a97c1db388279daaecf41520ab646873df03cfb616c26f7076aacc3efb46a7b10e2f369df27060097ce8557be44743c8ab5aebe0002d5fcf5bb3a81f56b5be1c6b4de21e2c3c223eeed514f208a2e768dbb97a407cfd81206dcd59778284138303b58d1133bd3f6aa79ca322dfd91a25c795f58a48cbbed66309d35719ca7136b72d3a55247dddf70d31778e8ad58d582fd4134136cced4cbd7f5f6608c10b55314e70eba83d7e39628ff693402e4863486d87ebe78d86658b63707ff57d159a5a1f0e8430b392f0a11fd4a1a00e588ca4accefe2e8c1874e2191d62ea3c418136ab0d5f4c40ac0ccd4c1e3c1ad9f836eb2a63d8fd4379f7d422155d98e45da4e734a4b88227fe89c31a331256fe58c60da04b04a9d92296c9586e28ddb322c93bc41e647132ff4260e4ef0120291a4ccbb3b4036b486b6f06feb1f9d6aa0cd94485b43ff17a84e685f58d629d6dd1bc48c20a77f6d3c0a0bf2cbf20d29154d028072b841b8baea876d3632457db5265f9ff076975b68f0652f21c7b7c091ea69bca960bb0ab0f5d1f9ebe50979b194bfe161aefc48caf3335ebc26c7b47aaa5e7044d4ba40e8ff7ef19bef2b31aaf5b2946d7dc04f64e6d7b5048216c94de077896a059ea46c9afa3c3913d38097254ae09569567ead75cad7b1c18cf3607128e7be82e8b861abbf5feea3a7a64de6f54e7d3ca738d2dcab2865b99e4c57afb494686628e2d464cade8ad3716303b421a246e197900f1b3867e32caabc8c78fdb226b32e3b261edb898e8049eeee94a22936d904f9f19b1413e29bac1c0359aa87e284169e452b8cb914767081e4317925a9aaec39a612afe833a8db0df382323b13854cbd4eaf3a8c8a2639bd0b5edc5601a989c6a77af07ef7b8908616e0bb7e66a779780234ed724d9bb717781d3398d0b4c149ae8a42f1196b2a41860a3e2e9b7b11d128436313639045e65a284ecef6011961b69b63bd0e2b6860eebe34789cf2be59b25e864ccf576c8af4a1b7edc5a1cc5177115e3a8f45709706af2967ba2e68a674e1dd9fab43d5f184a9f9e72e59b139394607ebff61dde5c3d39e4168a82fb1b0551d3c63778fd4a522da1f53183faeb1a8ef8603824a0909f6637d4a651e15c1b7185e40ff51c575939f58951367c90e7ce8d137cb638f07ad97752900ee116679a90be1a9a288cd83758399a9df2bd2cbdde763f7566859f4fb226d3cd4fa2371516b2a1f74e1a89bc4935c6fbe1a399e59979e9a8fcb20431e2f8c3a2ad2b46c099fd562caf6ab652455ec2f2c037e57b9cb077507947d217938287f13f0a5c78582ac5fd04612cb77776712367401b26077c621e3f3a3bb24316d2a8e0d780cc025ab24e645faa70a00d4c5fc082a56c29a2a662e603cd2c352a884359594bc07aeea4111a81f413b0fd79b5062eea324f84daf1aac27ca7b1ec13ef59316023f4f91adf7d3de2922a8716bca32a0952ee2cd78c1d221ea5450056c44e49ec7f7caddffce404a713e90dbb00b9a44dfdab37816b4864eb1192fc7ce9287d1a559959a6d002ca92639f8752d86aae19ae8cfc474875d08e2459f1de771f3a70066cc39ff727c22de9385fb34eeac71a744f552250a799a08fa403915af48c770892c9dfa3ed3b24d14f7d5eb1b9ebf249a2c5cad6ff23840299aa12354435c77a41334c628cf3acc324f6fe18f8d7ee4c7e5cee26ef86d91f9ed9d2a27b45f66cbfb3ac22c81a8b23212eef381b8aaf4920555efba691bb44b8e19ea2f8366c787cd00797bbeac307608b7d8dac159413368e7c1d61a1a375de916925d35feb0a04d3f26d42d272143c5c0d1eb7821f32774a81ba8d26f3447ba00047cc3f72bb3531e881c7831a546d07ce9e1a1511b7b6f598fb066199ee190253b1153bc76377b1e6208a1401b58685f57e672ebb25d2f9268d066aaf31daf9c9f55fe7b4d91f5a78304bc0e57eaad82548ea934e5702ef2e57157f2c8493e823fc2bf34a717a0f87e25e63221bc73480b89bbd2972cc3500d36f64f04204f0206302cdd50f4a6f28313d94aee89cfa3d2776593dc4a850b1a6c844e23b0e2d31ffe5023d3b1779bcf6b1d64a99dda8ecf592fed3df9c2111a5af080e8079785afcb1390473f7454207385e982fc7e4158a58563f1293e1f99a75156cf500df09e3cc44cdb78dea6617718180715dbf6a1fb429aabc94e85c8257ef71d5adb314b20b0b454011d07c5f30ffbb39a0e8f088333ffd6d8e59190f57685255581b8ab96875dcd92696795b1517870e525142b8de1c7ee9bb5adcb11053b9f52044d914fa47e8f8442388fee32b81e047cebd7c69ffadd40dfb3c59bd15e0d92f0d0fe36b97588652016ed802dba9faaeda1a3468af1dc89497f48ea376909bd47a6589a5a131cbd99c11469c05c0b60366ca0dc4882e5632cbf8aff64d564f1ba54697c5c28299025256089a5afc02160c18e73b82748801b55b9ede991b74ab4f841c934e4134cb33856b21f3fccb7ff3cc0cdbf7fe373be3c249ce26b7dbf290704e789e9df92b1ab337d5985e4c880415f826923fbc7c8b92d0b62ed1bb96927da57a3438c4d2a9f3896abb509be33e49f44413b848e0c4b8805acc341deac7268ce74ad4db66ec816f65138a62e2160ff038671fd7313e707e89d551bc28eeb839b93d36141dcceacdc1b30a56ae66fa1f342c9854d3daddbf4dbc5f3dceed28ca63d87fa48a47fee54a806be297de53ef5509bd57afc623d04a8b4df8a1f3ceb722250f08b848cd49feb0998b73eac095c56c50f0da38a3957cd5c0f2ad424e1f94a2086bf16a138a437df4d0d3909ad2b81ecbe1b51ed4638c79d800e7534490e3e220a47463cd65de2788037740d74ab0867c1fcd4b1cf566276ff580e274916506ec8879dd8e35df6abed422948639093d68f0a1215b83f090d221c97f02a96936b05e8dab3f2b82a07c0ac44a82064804de8d78d672975a1d0e9c4109ba5d7b36505e5ba1c5624d868717e517c8ea6056a8af3348ca1fd0d71aec50bb086cec11c3197bbfd985ddb626b069ae61d24a5455e670c0c5fc7036016dcafc1c9b006adb07bc02e8ee16426c2a5127e7c8febc30e3c2b5731bcd0e66cd90cb760287543ca2594ca949ec2d3c06e6c392b95ef8917cef3f32d1a979585132c6bee524574")
	
	ciphertext := []byte(cipherstring)
//	password := []byte("testpassword2")
	password := []byte(os.Args[1])

	c, err := triplesec.NewCipher(password, nil)
	if err != nil {
		fmt.Println(err)
	}
	

//	orig_plaintext := append([]byte{}, plaintext...)
//	fmt.Println(orig_plaintext)
//	ciphertext, err := c.Encrypt(plaintext)
//	if err != nil {
//		fmt.Println(err)
//	}

//	orig_ciphertext := append([]byte{}, ciphertext...)
//	fmt.Println(orig_ciphertext)
	new_plaintext, err := c.Decrypt(ciphertext)
//	fmt.Println(new_plaintext)
	if err != nil {
		fmt.Println(err)
	}
	
	str := hex.EncodeToString(new_plaintext)
	fmt.Println(str)

	
}